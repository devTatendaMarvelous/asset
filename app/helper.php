<?php


use Endroid\QrCode\QrCode;
use Endroid\QrCode\Writer\PngWriter;
use Endroid\QrCode\Writer\Result\PngResult;

function generateQr($id, $serial)
{
    $qrCode = new QrCode("$id@$serial");
    $writer = new PngWriter();

    /** @var PngResult $result */
    $result = $writer->write($qrCode);

    return base64_encode($result->getString());


}


function cardTemplate($asset)
{
    $logo = base64_encode(file_get_contents(public_path('main-logo.png')));

    $card = '<?xml version="1.0" encoding="utf-8"?>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1605" height="979" viewBox="0 0 1605 979">
  <defs>
    <style>
      .cls-1 {
        fill: #575898;
      }

      .cls-2 {
        fill: #f2f6f9;
      }

      .cls-3 {
        fill: #060606;
      }

      .cls-3, .cls-4 {
        fill-rule: evenodd;
      }

      .cls-4 {
        fill: #fff;
      }
    </style>
  </defs>
  <rect class="cls-1" x="-2.969" width="1616.409" height="1238.75"/>
  <rect class="cls-2" x="-8" width="1621.44" height="423"/>

  <image id="main-logo" x="28" y="60" width="901" height="277" xlink:href="data:img/png;base64,'.$logo.'"/>
  <image id="A430CA98" x="1246" y="539" width="304" height="302" xlink:href="data:img/png;base64,iVBORw0KGgoAAAANSUhEUgAAATAAAAEuCAYAAAAJJ04YAAAEHklEQVR4nO3UMUpDAQAFwWf42Fgkfe5/rXT2iYUgpJB/jIWZKyzsx8/v32PbbQAtz2PbfduncEDM12XboRoQdJwDeykHBL0uqgFVBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkGVgQJaBAVkGBmQZGJBlYECWgQFZBgZkGRiQZWBAloEBWQYGZBkYkHUO7CofEHQ9B/ZWDgh6H9u+t93UA1K25z9zgA0wj76XhAAAAABJRU5ErkJggg=="/>
  <path id="asset_card" data-name="asset card" class="cls-3" d="M640.814,356.648l9.061,26.682H661.58L632.633,298.5H619.418L590.6,383.33h11.328l8.81-26.682h30.08ZM613,348.09l8.307-24.542c1.636-5.161,3.02-10.321,4.279-15.355h0.252c1.258,4.908,2.517,9.943,4.4,15.48l8.306,24.417H613Zm55.648,32.345c4.279,2.517,10.446,4.153,17.117,4.153,14.473,0,22.78-7.551,22.78-18.249,0-9.062-5.412-14.348-15.984-18.375-7.929-3.021-11.579-5.286-11.579-10.32,0-4.531,3.65-8.307,10.2-8.307a23.714,23.714,0,0,1,12.46,3.524l2.768-8.055a30.4,30.4,0,0,0-14.977-3.776c-13.089,0-21.018,8.055-21.018,17.872,0,7.3,5.16,13.341,16.11,17.243,8.181,3.02,11.327,5.915,11.327,11.2,0,5.034-3.776,9.062-11.83,9.062a29.032,29.032,0,0,1-14.6-4.405Zm49.851,0c4.28,2.517,10.447,4.153,17.117,4.153,14.474,0,22.78-7.551,22.78-18.249,0-9.062-5.412-14.348-15.984-18.375-7.929-3.021-11.579-5.286-11.579-10.32,0-4.531,3.65-8.307,10.2-8.307a23.708,23.708,0,0,1,12.46,3.524l2.769-8.055a30.4,30.4,0,0,0-14.977-3.776c-13.09,0-21.019,8.055-21.019,17.872,0,7.3,5.161,13.341,16.11,17.243,8.181,3.02,11.327,5.915,11.327,11.2,0,5.034-3.775,9.062-11.83,9.062a29.035,29.035,0,0,1-14.6-4.405Zm103.089-25.549a41.735,41.735,0,0,0,.378-5.16c0-11.2-5.286-28.7-25.171-28.7-17.746,0-28.57,14.474-28.57,32.849s11.2,30.709,29.954,30.709c9.691,0,16.361-2.013,20.263-3.775l-1.888-7.929c-4.153,1.762-8.936,3.146-16.865,3.146-11.075,0-20.64-6.167-20.892-21.144h42.791Zm-42.665-7.929c0.881-7.677,5.789-18,16.991-18,12.459,0,15.48,10.95,15.354,18H778.922Zm59.293-39.142v14.6h-9.439v8.432h9.439v33.227c0,7.174,1.133,12.585,4.279,15.858,2.643,3.02,6.8,4.656,11.957,4.656a27.116,27.116,0,0,0,9.817-1.51l-0.5-8.306a24.662,24.662,0,0,1-6.419.755c-6.167,0-8.306-4.279-8.306-11.831V330.847H864.9v-8.432H849.039V304.921Zm123.229,64.062c-4.4,2.139-11.2,3.524-17.872,3.524-20.64,0-32.6-13.341-32.6-34.108,0-22.276,13.215-34.988,33.1-34.988a39.883,39.883,0,0,1,17.117,3.524l2.643-8.936c-2.895-1.51-9.566-3.776-20.138-3.776-26.3,0-44.3,18-44.3,44.554,0,27.815,18,42.917,41.911,42.917,10.32,0,18.375-2.013,22.4-4.027Zm58.546,11.453a85.257,85.257,0,0,1-1.01-14.6V345.95c0-12.208-4.53-24.92-23.159-24.92-7.678,0-14.977,2.14-20.012,5.412l2.518,7.3a30.348,30.348,0,0,1,15.858-4.531c12.455,0,13.845,9.062,13.845,14.1v1.259C984.494,344.44,971.4,352.5,971.4,367.22c0,8.81,6.293,17.494,18.627,17.494a22.7,22.7,0,0,0,18.629-9.061h0.38l0.88,7.677h10.07Zm-11.71-20.515a11.488,11.488,0,0,1-.63,3.524,15.148,15.148,0,0,1-14.724,10.195c-5.664,0-10.446-3.4-10.446-10.572,0-11.831,13.718-13.971,25.8-13.719v10.572Zm28.58,20.515h10.95V350.859a31.336,31.336,0,0,1,.51-5.161c1.51-8.306,7.05-14.221,14.85-14.221a16.556,16.556,0,0,1,3.77.377V321.408a11.872,11.872,0,0,0-3.14-.378c-7.43,0-14.1,5.161-16.87,13.341h-0.5l-0.38-11.956h-9.69c0.38,5.663.5,11.83,0.5,19V383.33Zm81.44-89.359v36.373h-0.25c-2.77-4.909-9.06-9.314-18.37-9.314-14.85,0-27.44,12.46-27.31,32.723,0,18.5,11.32,30.961,26.05,30.961,9.94,0,17.37-5.16,20.77-11.956h0.25l0.5,10.572h9.94c-0.37-4.153-.5-10.32-0.5-15.732V293.971H1118.3Zm0,63.81a19.122,19.122,0,0,1-.5,4.782c-2.01,8.307-8.81,13.215-16.23,13.215-11.96,0-18-10.194-18-22.528,0-13.467,6.79-23.535,18.25-23.535a16.293,16.293,0,0,1,15.98,12.837,19.419,19.419,0,0,1,.5,4.657v10.572Z"/>

  <path id="Reg_No:" data-name="Reg No:" class="cls-4" d="M85.674,822.39h8.519V793.8h8.029c7.736,0.294,11.261,3.721,13.219,12.827,1.861,8.225,3.329,13.9,4.406,15.765h8.813c-1.371-2.546-2.937-8.91-5.092-18.115-1.566-6.854-4.6-11.554-9.694-13.317v-0.293c6.953-2.35,12.436-8.128,12.436-16.842a16.436,16.436,0,0,0-5.19-12.534c-4.112-3.721-9.987-5.386-19.094-5.386a88.755,88.755,0,0,0-16.352,1.371V822.39Zm8.519-59.143a35.091,35.091,0,0,1,8.421-.783c9.008,0.1,15.177,3.819,15.177,12.338,0,7.539-5.777,12.533-14.884,12.533H94.193V763.247ZM172.54,784.4H146.885V763.541h27.124v-7.148H138.366v66h37.112v-7.148H146.885V791.448H172.54V784.4Zm64.245,3.329H215.047v6.854h13.415v19.682c-1.958.979-5.777,1.763-11.358,1.763-15.374,0-25.459-9.89-25.459-26.634,0-16.549,10.477-26.536,26.536-26.536a34.223,34.223,0,0,1,14.59,2.839l2.056-6.952c-2.84-1.371-8.813-3.035-16.45-3.035-22.13,0-35.643,14.394-35.741,34.075,0,10.282,3.525,19.094,9.205,24.578,6.462,6.169,14.688,8.715,24.675,8.715a61.473,61.473,0,0,0,20.269-3.623V787.727Zm41.831,34.663v-28.2c0-10.967-.2-18.9-0.686-27.222l0.294-.1A209.492,209.492,0,0,0,290.562,788.9l20.955,33.488h8.616v-66H312.1v27.613c0,10.282.2,18.311,0.979,27.124l-0.2.1a186.737,186.737,0,0,0-11.848-21.445l-21.15-33.39h-9.3v66h8.029Zm83.148-67.074c-17.626,0-30.649,13.709-30.649,34.663,0,19.976,12.24,33.488,29.669,33.488,16.842,0,30.649-12.044,30.649-34.761C391.433,769.122,379.781,755.316,361.764,755.316Zm-0.392,6.952c14.2,0,21.052,13.709,21.052,26.83,0,14.981-7.637,27.417-21.15,27.417-13.415,0-21.053-12.631-21.053-26.732C340.221,775.291,347.272,762.268,361.372,762.268ZM405.941,788.9c3.623,0,5.875-2.644,5.875-6.071-0.1-3.623-2.35-6.169-5.777-6.169s-5.875,2.546-5.875,6.169A5.74,5.74,0,0,0,405.941,788.9Zm0,34.565c3.623,0,5.875-2.643,5.875-6.071-0.1-3.623-2.35-6.168-5.777-6.168s-5.875,2.545-5.875,6.168A5.739,5.739,0,0,0,405.941,823.467Z"/>

    <text x="610" y="680" font-size="85" font-family="Arial"  fill="#010101" text-anchor="middle" id="John_Doe"
          class="cls-4" >'.$asset->user->name.'</text>


    <text x="650" y="820" font-size="85" font-family="Arial"  fill="#010101" text-anchor="middle" id="John_Doe"
          class="cls-4" >'.$asset->user->reg_number.'</text>

    <image x="1240" y="210" width="310.044" height="962.966" href="data:image/png;base64,' . generateQr($asset->id, $asset->serial_number) . '" />

</svg>';


    return  $card;

}
